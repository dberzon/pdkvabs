#N canvas 612 293 1161 724 12;
#X obj 23 620 *~;
#X obj 296 575 *~;
#X obj 263 574 *~;
#X obj 361 576 *~;
#X obj 329 575 *~;
#X obj 329 597 +~;
#X obj 263 599 -~;
#X obj 565 503 *~;
#X obj 59 244 *~;
#X obj 27 244 *~;
#X obj 27 265 +~;
#X obj 330 202 *~;
#X obj 298 202 *~;
#X obj 613 432 *~;
#X obj 581 432 *~;
#X obj 98 183 *~;
#X obj 23 642 outlet~;
#X obj 23 595 *~;
#X obj 89 34 inlet~;
#X obj 98 204 rfft~;
#X obj 23 571 rifft~;
#X obj 581 454 rsqrt~;
#X obj 298 223 +~;
#X obj 489 503 *~;
#X obj 61 619 sig~ 0.0002;
#N canvas 167 161 699 396 decision 0;
#X obj 49 101 inlet~;
#X obj 50 341 outlet~;
#X obj 50 183 -~;
#X obj 50 226 clip~ 0 1;
#X obj 50 204 *~ 1e+20;
#X obj 196 98 inlet~;
#X text 137 213 stronger than;
#X text 139 228 old one;
#X obj 274 202 -~;
#X obj 288 177 lrshift~ 1;
#X obj 274 250 clip~ 0 1;
#X obj 274 228 *~ 1e+20;
#X obj 450 202 -~;
#X obj 450 250 clip~ 0 1;
#X obj 450 228 *~ 1e+20;
#X obj 464 177 lrshift~ -1;
#X obj 50 283 *~;
#X obj 50 312 *~;
#X text 135 199 1 if new signal;
#X text 55 73 new;
#X text 203 70 old;
#X text 51 12 Choose whether to replace the "old" signal with the "new"
one. The "new" one must be stronger than the old one and also must
be stronger than its two neighboring channels;
#X text 267 283 1 if we're louder than neighbor;
#X connect 0 0 2 0;
#X connect 0 0 9 0;
#X connect 0 0 8 0;
#X connect 0 0 12 0;
#X connect 0 0 15 0;
#X connect 2 0 4 0;
#X connect 3 0 16 0;
#X connect 4 0 3 0;
#X connect 5 0 2 1;
#X connect 8 0 11 0;
#X connect 9 0 8 1;
#X connect 10 0 16 1;
#X connect 11 0 10 0;
#X connect 12 0 14 0;
#X connect 13 0 17 1;
#X connect 14 0 13 0;
#X connect 15 0 12 1;
#X connect 16 0 17 0;
#X connect 17 0 1 0;
#X restore 28 292 pd decision;
#X obj 581 476 *~, f 54;
#N canvas 276 481 755 363 divide-by-prev 0;
#X obj 283 99 inlet~;
#X obj 385 101 inlet~;
#X obj 284 249 outlet~;
#X obj 386 249 outlet~;
#X obj 107 251 outlet~;
#X obj 208 253 outlet~;
#X obj 250 180 *~;
#X obj 217 180 *~;
#X obj 182 181 *~;
#X obj 149 181 *~;
#X obj 149 203 +~;
#X obj 217 202 -~;
#X obj 92 49 tabreceive~ \$0-last-real;
#X obj 190 72 tabreceive~ \$0-last-imag;
#X connect 0 0 2 0;
#X connect 0 0 9 0;
#X connect 0 0 6 0;
#X connect 1 0 3 0;
#X connect 1 0 8 0;
#X connect 1 0 7 0;
#X connect 6 0 11 1;
#X connect 7 0 11 0;
#X connect 8 0 10 1;
#X connect 9 0 10 0;
#X connect 10 0 4 0;
#X connect 11 0 5 0;
#X connect 12 0 9 1;
#X connect 12 0 7 1;
#X connect 13 0 8 1;
#X connect 13 0 6 1;
#X restore 608 312 pd divide-by-prev;
#N canvas 650 183 602 327 switch 0;
#X obj 19 163 inlet~;
#X obj 107 99 inlet~;
#X obj 169 100 inlet~;
#X obj 273 97 inlet~;
#X obj 333 97 inlet~;
#X obj 367 185 -~;
#X obj 338 231 +~;
#X obj 372 229 *~;
#X obj 250 182 -~;
#X obj 220 228 +~;
#X obj 254 228 *~;
#X obj 219 278 outlet~;
#X obj 338 274 outlet~;
#X text 46 28 switch between two pairs of inputs. If first inlet is
one \, take the left-hand pair \, otherwise the right-hand one.;
#X text 15 140 switch;
#X text 92 76 pass this if one;
#X text 269 77 pass this if zero;
#X connect 0 0 10 1;
#X connect 0 0 7 1;
#X connect 1 0 8 0;
#X connect 2 0 5 0;
#X connect 3 0 9 0;
#X connect 3 0 8 1;
#X connect 4 0 6 0;
#X connect 4 0 5 1;
#X connect 5 0 7 0;
#X connect 6 0 12 0;
#X connect 7 0 6 1;
#X connect 8 0 10 0;
#X connect 9 0 11 0;
#X connect 10 0 9 1;
#X restore 332 395 pd switch;
#N canvas 650 183 602 327 switch 0;
#X obj 19 163 inlet~;
#X obj 107 99 inlet~;
#X obj 169 100 inlet~;
#X obj 273 97 inlet~;
#X obj 333 97 inlet~;
#X obj 367 185 -~;
#X obj 338 231 +~;
#X obj 372 229 *~;
#X obj 250 182 -~;
#X obj 220 228 +~;
#X obj 254 228 *~;
#X obj 219 278 outlet~;
#X obj 338 274 outlet~;
#X text 46 28 switch between two pairs of inputs. If first inlet is
one \, take the left-hand pair \, otherwise the right-hand one.;
#X text 15 140 switch;
#X text 92 76 pass this if one;
#X text 269 77 pass this if zero;
#X connect 0 0 10 1;
#X connect 0 0 7 1;
#X connect 1 0 8 0;
#X connect 2 0 5 0;
#X connect 3 0 9 0;
#X connect 3 0 8 1;
#X connect 4 0 6 0;
#X connect 4 0 5 1;
#X connect 5 0 7 0;
#X connect 6 0 12 0;
#X connect 7 0 6 1;
#X connect 8 0 10 0;
#X connect 9 0 11 0;
#X connect 10 0 9 1;
#X restore 489 386 pd switch;
#X obj 510 232 tabreceive~ \$0-inc-real;
#X obj 592 254 tabreceive~ \$0-inc-imag;
#X obj 757 340 tabsend~ \$0-last-imag;
#X obj 707 363 tabsend~ \$0-last-real;
#X obj 564 546 tabsend~ \$0-inc-imag;
#X obj 489 569 tabsend~ \$0-inc-real;
#X msg 286 97 set \$1 4;
#X obj 286 119 block~;
#X text 25 326 choose whether to;
#X text 23 344 punch in new (amplitude \,;
#X text 21 363 increment) pair;
#X obj 372 146 tabreceive~ \$0-amp-real;
#X obj 448 170 tabreceive~ \$0-amp-imag;
#X obj 330 657 tabsend~ \$0-amp-imag;
#X obj 263 680 tabsend~ \$0-amp-real;
#X text 366 126 previous output amplitude \, encoding both magnitude
and phase;
#X text 458 207 previous phase increment (unit-magnitude complex number)
;
#X obj 511 254 +~ 1e-15;
#X obj 371 170 +~ 1e-15;
#X text 368 602 propagate amplitudes by multiplying in the;
#X text 366 619 increments \, which advance the phase and drop;
#X text 370 634 magnitude according to revtime.;
#X text 613 490 normalize increments between 0 and;
#X text 611 508 1 according to revtime.;
#X text 83 573 IFFT and output;
#X obj 971 58 inlet;
#N canvas 630 268 954 623 tables 0;
#X obj 63 124 array define \$0-inc-imag;
#X obj 60 151 array define \$0-inc-real;
#X obj 77 184 array define \$0-last-imag;
#X obj 69 211 array define \$0-last-real;
#X obj 76 244 array define \$0-amp-imag;
#X obj 73 271 array define \$0-amp-real;
#X obj 282 257 array size \$0-inc-imag;
#X obj 279 284 array size \$0-inc-real;
#X obj 296 317 array size \$0-last-imag;
#X obj 288 344 array size \$0-last-real;
#X obj 295 377 array size \$0-amp-imag;
#X obj 292 404 array size \$0-amp-real;
#X obj 287 42 inlet;
#X obj 295 74 max 1;
#X obj 300 180 / 1;
#X connect 12 0 13 0;
#X connect 13 0 14 0;
#X connect 14 0 6 0;
#X connect 14 0 7 0;
#X connect 14 0 8 0;
#X connect 14 0 9 0;
#X connect 14 0 10 0;
#X connect 14 0 11 0;
#X restore 375 103 pd tables;
#X obj 293 40 f \$1;
#X obj 289 11 loadbang;
#X obj 967 133 max 0.2;
#X obj 967 157 t b f;
#X msg 967 181 0.2;
#X obj 967 205 /, f 6;
#X obj 967 229 t b f;
#X msg 967 253 1;
#X obj 967 277 -, f 8;
#X obj 970 106 f \$2;
#X msg 967 301 \$1 1;
#X obj 967 325 line~;
#X obj 293 64 t f f f;
#X obj 1057 45 loadbang;
#X text 586 46 args: fft size \, reverb time;
#X text 593 73 inlets: sig \, reverb time;
#X obj 164 153 pdkvabs/dkhannblock~ \$1;
#X connect 0 0 16 0;
#X connect 1 0 6 1;
#X connect 2 0 6 0;
#X connect 3 0 5 1;
#X connect 4 0 5 0;
#X connect 5 0 43 0;
#X connect 6 0 44 0;
#X connect 7 0 1 0;
#X connect 7 0 3 0;
#X connect 7 0 34 0;
#X connect 8 0 10 1;
#X connect 9 0 10 0;
#X connect 10 0 25 0;
#X connect 11 0 22 1;
#X connect 12 0 22 0;
#X connect 13 0 21 0;
#X connect 14 0 21 0;
#X connect 15 0 19 0;
#X connect 17 0 0 0;
#X connect 18 0 15 0;
#X connect 19 0 9 0;
#X connect 19 0 9 1;
#X connect 19 0 27 0;
#X connect 19 0 28 1;
#X connect 19 1 8 0;
#X connect 19 1 8 1;
#X connect 19 1 27 1;
#X connect 19 1 28 2;
#X connect 20 0 17 0;
#X connect 21 0 26 0;
#X connect 22 0 25 1;
#X connect 23 0 2 0;
#X connect 23 0 4 0;
#X connect 23 0 35 0;
#X connect 24 0 0 1;
#X connect 25 0 28 0;
#X connect 25 0 29 0;
#X connect 26 0 23 1;
#X connect 26 0 7 1;
#X connect 27 0 29 1;
#X connect 27 1 29 2;
#X connect 27 2 33 0;
#X connect 27 3 32 0;
#X connect 28 0 20 0;
#X connect 28 0 3 1;
#X connect 28 0 2 1;
#X connect 28 1 20 1;
#X connect 28 1 1 1;
#X connect 28 1 4 1;
#X connect 29 0 14 0;
#X connect 29 0 14 1;
#X connect 29 0 23 0;
#X connect 29 1 13 0;
#X connect 29 1 13 1;
#X connect 29 1 7 0;
#X connect 30 0 47 0;
#X connect 31 0 29 4;
#X connect 36 0 37 0;
#X connect 41 0 48 0;
#X connect 42 0 11 0;
#X connect 42 0 11 1;
#X connect 42 0 28 4;
#X connect 47 0 29 3;
#X connect 48 0 12 0;
#X connect 48 0 12 1;
#X connect 48 0 28 3;
#X connect 55 0 66 0;
#X connect 57 0 69 0;
#X connect 58 0 57 0;
#X connect 59 0 60 0;
#X connect 60 0 61 0;
#X connect 60 1 62 1;
#X connect 61 0 62 0;
#X connect 62 0 63 0;
#X connect 63 0 64 0;
#X connect 63 1 65 1;
#X connect 64 0 65 0;
#X connect 65 0 67 0;
#X connect 66 0 59 0;
#X connect 67 0 68 0;
#X connect 68 0 26 1;
#X connect 69 0 36 0;
#X connect 69 1 73 0;
#X connect 69 2 56 0;
#X connect 70 0 66 0;
#X connect 73 0 17 1;
#X connect 73 0 15 1;
